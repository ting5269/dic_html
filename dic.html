<!DOCTYPE html>
<html>
<head>
  <style>
    /* åŸºæœ¬æ¨£å¼èª¿æ•´ */
    body {
      font-family: 'Microsoft JhengHei', sans-serif;
      background: linear-gradient(135deg, #1a1a2e, #2978b5, #16213e);
      color: #fff;
      margin: 0;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .container {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(15px);
      border-radius: 20px;
      padding: 2rem;
      box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
      width: 90%;
      max-width: 500px;
    }

    .title {
      text-align: center;
      color: #29c7ac;
      font-size: 2rem;
      margin-bottom: 1.5rem;
      text-shadow: 0 0 15px rgba(41, 199, 172, 0.7);
    }

    .game-menu, .auth-form {
      display: grid;
      grid-template-columns: 1fr;
      gap: 1rem;
      margin-top: 1rem;
    }

    .menu-item, .auth-item {
      background: linear-gradient(45deg, #2978b5, #29c7ac);
      color: white;
      padding: 0.8rem;
      border-radius: 10px;
      text-align: center;
      cursor: pointer;
      border: none;
      font-size: 1rem;
      font-weight: bold;
    }

    #output {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 10px;
      padding: 1rem;
      margin-top: 1rem;
      text-align: center;
      white-space: pre-line;
      font-size: 1rem;
      line-height: 1.4;
    }

    input[type="text"], input[type="password"] {
      padding: 0.5rem;
      border-radius: 5px;
      border: none;
      font-size: 1rem;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1 class="title">ğŸ² ç‚«å½©éª°å­éŠæˆ²</h1>
    
    <!-- è¨»å†Šå’Œç™»å…¥è¡¨å–® -->
    <div id="auth" class="auth-form">
      <input id="authUserId" type="text" placeholder="è«‹è¼¸å…¥ä½ çš„ID">
      <input id="authPassword" type="password" placeholder="è«‹è¼¸å…¥ä½ çš„å¯†ç¢¼">
      <button class="auth-item" onclick="register()">è¨»å†Š</button>
      <button class="auth-item" onclick="login()">ç™»å…¥</button>
    </div>
    
    <!-- éŠæˆ²é¸å–® -->
    <div id="gameMenu" class="game-menu" style="display: none;">
      <button class="menu-item" onclick="joinGame()">åŠ å…¥éŠæˆ²</button>
      <button class="menu-item" onclick="dailyCheckIn()">æ¯æ—¥ç°½åˆ°</button>
      <button class="menu-item" onclick="showWallet()">æŸ¥çœ‹éŒ¢åŒ…</button>
      <button class="menu-item" onclick="showRanking()">æŸ¥çœ‹æ’å</button>
      <button class="menu-item" onclick="placeBet()">ä¸‹æ³¨</button>
    </div>
    
    <div id="output">
      æ­¡è¿ä¾†åˆ°ç‚«å½©éª°å­éŠæˆ²ï¼
    </div>
  </div>

  <script>
    let players = JSON.parse(localStorage.getItem("players")) || {};
    let currentUser = null;
    const initialChips = 5000;
    const dailyReward = 5000;

    function register() {
      const userId = document.getElementById("authUserId").value;
      const password = document.getElementById("authPassword").value;

      if (!userId || !password) {
        alert("è«‹å¡«å¯«IDå’Œå¯†ç¢¼é€²è¡Œè¨»å†Šï¼");
        return;
      }
      if (players[userId]) {
        alert("è©²IDå·²å­˜åœ¨ï¼Œè«‹å˜—è©¦å…¶ä»–IDï¼");
        return;
      }

      players[userId] = {
        chips: initialChips,
        claimedReward: false,
        lastClaimed: new Date().getTime() - 86400000,
        password: password,
        name: `ç©å®¶ ${userId}`,
        wins: 0,
        losses: 0
      };
      alert("è¨»å†ŠæˆåŠŸï¼è«‹ç™»å…¥ã€‚");
      saveData();
    }

    function login() {
      const userId = document.getElementById("authUserId").value;
      const password = document.getElementById("authPassword").value;

      if (!userId || !password) {
        alert("è«‹å¡«å¯«IDå’Œå¯†ç¢¼é€²è¡Œç™»å…¥ï¼");
        return;
      }
      if (!players[userId] || players[userId].password !== password) {
        alert("IDæˆ–å¯†ç¢¼éŒ¯èª¤ï¼Œè«‹é‡æ–°è¼¸å…¥ï¼");
        return;
      }

      currentUser = userId;
      document.getElementById("auth").style.display = "none";
      document.getElementById("gameMenu").style.display = "grid";
      document.getElementById("output").innerText = `${players[userId].name}ï¼Œæ­¡è¿ç™»å…¥ï¼`;
    }

    function joinGame() {
      if (!currentUser) return;
      document.getElementById("output").innerText = 
        `${players[currentUser].name}ï¼Œæ­¡è¿åŠ å…¥éŠæˆ²ï¼\nä½ æœ‰ ${players[currentUser].chips} å€‹ç±Œç¢¼ã€‚`;
    }

    function dailyCheckIn() {
      if (!currentUser) return;

      let player = players[currentUser];
      let currentTime = new Date().getTime();
      if (currentTime - player.lastClaimed >= 86400000) {
        player.chips += dailyReward;
        player.claimedReward = true;
        player.lastClaimed = currentTime;
        document.getElementById("output").innerText = 
          `${player.name}ï¼Œç°½åˆ°æˆåŠŸï¼\nä½ ç²å¾—äº† ${dailyReward} å€‹ç±Œç¢¼ã€‚\nç•¶å‰ç±Œç¢¼: ${player.chips}`;
      } else {
        document.getElementById("output").innerText = 
          `${player.name}ï¼Œä»Šå¤©å·²ç¶“ç°½åˆ°éäº†ï¼Œè«‹æ˜å¤©å†ä¾†ï¼`;
      }
      saveData();
    }

    function showWallet() {
      if (!currentUser) return;
      
      let player = players[currentUser];
      document.getElementById("output").innerText = 
        `ç©å®¶åç¨±: ${player.name}\n` +
        `ç±Œç¢¼æ•¸é‡: ${player.chips}\n` +
        `å‹å ´: ${player.wins}\n` +
        `æ•—å ´: ${player.losses}\n` +
        `å‹ç‡: ${((player.wins / (player.wins + player.losses)) * 100 || 0).toFixed(1)}%\n` +
        `æ¯æ—¥ç°½åˆ°: ${player.claimedReward ? "å·²é ˜å–" : "æœªé ˜å–"}`;
    }

    function placeBet() {
      if (!currentUser) return;

      let amount = parseInt(prompt("è«‹è¼¸å…¥ä¸‹æ³¨é‡‘é¡:"));
      if (isNaN(amount) || amount > players[currentUser].chips || amount <= 0) {
        document.getElementById("output").innerText = 
          "ä¸‹æ³¨é‡‘é¡ç„¡æ•ˆæˆ–ç±Œç¢¼ä¸è¶³ï¼Œè«‹é‡æ–°ä¸‹æ³¨ã€‚";
        return;
      }

      let dealerSum = rollDice();
      let playerSum = rollDice();
      let result = playerSum > dealerSum ? "å‹åˆ© ğŸ‰" : "å¤±æ•— ğŸ˜¢";

      players[currentUser].chips += result.includes("å‹åˆ©") ? amount : -amount;
      players[currentUser][result.includes("å‹åˆ©") ? "wins" : "losses"] += 1;

      document.getElementById("output").innerText = 
        `èŠå®¶é»æ•¸: ${dealerSum}\n` +
        `ç©å®¶é»æ•¸: ${playerSum}\n` +
        `çµæœ: ${result}\n` +
        `ç±Œç¢¼è®ŠåŒ–: ${result.includes("å‹åˆ©") ? "+" : "-"}${amount}\n` +
        `ç•¶å‰ç±Œç¢¼: ${players[currentUser].chips}`;
      
      saveData();
    }

    function rollDice() {
      return Math.floor(Math.random() * 6) + 1 + Math.floor(Math.random() * 6) + 1;
    }

    function saveData() {
      localStorage.setItem("players", JSON.stringify(players));
    }

    function showRanking() {
    if (!currentUser) return;

    // å°‡ç©å®¶è³‡æ–™è½‰æ›æˆé™£åˆ—ï¼Œä¸¦æ ¹æ“šç±Œç¢¼æ•¸é‡å¾å¤šåˆ°å°‘æ’åº
    let ranking = Object.values(players).sort((a, b) => b.chips - a.chips);

    // é¡¯ç¤ºæ’åï¼Œæœ€å¤šé¡¯ç¤ºå‰ 5 å
    let rankingText = "ğŸ† ç©å®¶æ’å:\n";
    ranking.slice(0, 5).forEach((player, index) => {
        // åˆ¤æ–·ç•¶å‰ç©å®¶æ˜¯å¦ç‚ºç™»å…¥ç©å®¶
        if (player.name === players[currentUser].name) {
        // ç•¶å‰ç©å®¶æ¨™è¨»ç®­é ­ç¬¦è™Ÿä¸¦ä½¿ç”¨ç‰¹å®šé¡è‰² (ä¾‹å¦‚çµ¢å½©è—)
        rankingText += `â¡ï¸${index + 1}. ${player.name}</span> - ç±Œç¢¼: ${player.chips}\n`;
        } else {
        rankingText += `${index + 1}. ${player.name} - ç±Œç¢¼: ${player.chips}\n`;
        }
    });

    document.getElementById("output").innerHTML = rankingText;
    }



  </script>
</body>
</html>
